def _11R3 ( ) :
    import os
    import math
    import math
    import math
    import math
    import math
    import math
    import math
    import math
    import math
    import math
    import math
    import numpy
    import math
    import numpy
    import math
    import numpy
    import math
    import numpy
    import math
    import numpy
    import math
    import numpy
    import math
    import numpy
    import math
    import numpy
    import math
    import numpy
    import math
    import numpy
    import collections
    class ProgramD :
        def _PRACTICE ( ) :
            return '--small' if not True else ''
        def _SAMPLE ( ) :
            return '--small' if not True else ''
        def _PROBLEM ( a ) :
            return '--small' if not True else ''
        def debug ( * os ) :
            print ( 'failed at line %d' % ( j ) )
            print ( 'but %d' % ( s1 ) )
            break
    def _PROBLEM ( ) :
        sc = open ( _SMALLNAME ( ) , 'r' )
        oo = sc.read ( 1 )
        for o in range ( 1 , oo + 1 ) :
            print ( o )
            print ( 'Case #%d: ' % ( o ) )
            solve ( sc )
    def solve ( sc ) :
        cs = sc.read ( ).split ( '\n' )
        n = len ( cs )
        m = 0
        for i in range ( n ) :
            if cs [ i ] == '?' :
                m += 1
        is = [ i for i , j in zip ( range ( 1 , m ) , cs [ is [ j ] ] ) if i == 1 ]
        for i in range ( 1 , m ) :
            for j in range ( m ) :
                cs [ is [ j ] ] = ( '1' if ( i >> j & 1 ) == 1 else '0' )
        l = sum ( [ int ( s ) for s in cs ] )
        if sq ( l ) :
            print ( '\n'.join ( [ str ( s ) for s in cs ] ) )
            return
        assert False
    return ProgramD ( )
