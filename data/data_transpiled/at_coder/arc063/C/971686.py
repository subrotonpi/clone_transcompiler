def _main ( ) :
    import sys
    import os
    import subprocess
    import subprocess
    import time
    import random
    import subprocess
    import subprocess
    import subprocess
    import sys
    import subprocess
    import subprocess
    import sys
    import subprocess
    import subprocess
    import sys
    import subprocess
    import sys
    import subprocess
    import sys
    import time
    try :
        n = randint ( 0 , sys.maxint )
        g = [ ]
        for i in range ( n ) :
            g.append ( [ ] )
    except subprocess.CalledProcessError :
        sys.exit ( 1 )
    def solve ( ) :
        try :
            return subprocess.check_output ( [ 'lul' , '-' ] )
        except subprocess.CalledProcessError :
            eof = True
            return None
    def get_inf ( ) :
        return int ( get_inf ( ) )
    def solve ( ) :
        try :
            return subprocess.check_output ( [ 'solve' , '-' ] )
        except subprocess.CalledProcessError :
            eof = True
            return None
    def solve ( ) :
        return subprocess.check_output ( [ 'solve' , '-' ] )
    def solve ( ) :
        try :
            return subprocess.check_output ( [ 'solve' , '-' ] )
        except subprocess.CalledProcessError :
            eof = True
            return None
    def solve ( ) :
        return subprocess.check_output ( [ 'solve' , '-' ] )
    def solve ( ) :
        try :
            return subprocess.check_output ( [ 'solve' , '-' ] )
        except subprocess.CalledProcessError :
            eof = True
            return None
    k = randint ( 0 , sys.maxint )
    fixed = [ ]
    val = [ ]
    root = - 1
    for i in range ( k ) :
        v = randint ( 0 , sys.maxint )
        fixed.append ( True )
        val.append ( True )
        root = v
    low = [ ]
    high = [ ]
    anything = [ ]
    has_ans = dfs1 ( root , - 1 )
    print ( 'Yes' if has_ans else 'No' )
    if has_ans :
        outp = [ ]
        outp.append ( val [ root ] )
        dfs2 ( root , - 1 , val )
        